# üéß AI Ambient Music Generator ‚Äî Product Requirements Document (PRD)

## üß© Vis√£o Geral

O **AI Ambient Music Generator** √© uma plataforma web que permite criar, visualizar e gerenciar m√∫sicas ambiente geradas por Intelig√™ncia Artificial.  
O objetivo √© automatizar a cria√ß√£o de faixas para relaxamento, medita√ß√£o e concentra√ß√£o, permitindo o render e upload direto para o YouTube.

O sistema utiliza **Next.js + shadcn/ui** no frontend e **FastAPI (Python)** no backend, com gera√ß√£o de m√∫sica via **Mubert API**, imagens via **OpenAI DALL¬∑E**, e renderiza√ß√£o de v√≠deo com **FFmpeg**.

---

## üéØ Objetivos do Produto

- Facilitar a gera√ß√£o e publica√ß√£o de m√∫sicas ambiente com IA.  
- Oferecer uma UI minimalista e intuitiva.  
- Permitir automa√ß√£o do fluxo completo: prompt ‚Üí m√∫sica ‚Üí capa ‚Üí v√≠deo ‚Üí upload.  
- Gerar conte√∫do original e livre de direitos autorais para uso comercial (YouTube).

---

## üë§ P√∫blico-Alvo

- Criadores de conte√∫do de **m√∫sica relaxante / meditativa**.  
- Desenvolvedores interessados em **IA generativa musical**.  
- Produtores que desejam **automatizar uploads para o YouTube**.

---

## üîê Autentica√ß√£o e Autoriza√ß√£o

### Sistema Multi-User
O sistema suporta m√∫ltiplos usu√°rios com isolamento completo de dados e recursos.

### M√©todo de Autentica√ß√£o
- **JWT (JSON Web Tokens)** customizado para autentica√ß√£o stateless.
- **Access Token**: dura√ß√£o de 15 minutos.
- **Refresh Token**: dura√ß√£o de 7 dias, armazenado em HttpOnly cookie.
- **Password Hashing**: bcrypt com salt rounds = 12.

### Fluxo de Autentica√ß√£o

1. **Registro (`POST /api/auth/register`)**
   - Input: `{ email, password, username }`
   - Valida√ß√µes: email √∫nico, senha m√≠nima 8 caracteres
   - Output: usu√°rio criado + tokens JWT

2. **Login (`POST /api/auth/login`)**
   - Input: `{ email, password }`
   - Output: access_token + refresh_token (cookie)

3. **Refresh Token (`POST /api/auth/refresh`)**
   - Input: refresh_token via cookie
   - Output: novo access_token

4. **Logout (`POST /api/auth/logout`)**
   - Invalida refresh_token e limpa cookies

### Prote√ß√£o de Rotas
- **Backend**: middleware JWT para validar token em todas as rotas protegidas.
- **Frontend**: HOC/middleware para redirecionar usu√°rios n√£o autenticados.
- Rotas p√∫blicas: `/auth/login`, `/auth/register`.
- Rotas protegidas: `/api/generate`, `/api/render`, `/api/upload`, `/api/history`.

---

## üë• Gerenciamento de Usu√°rios e Quotas

### Sistema de Quotas
Para controlar custos de API e uso de recursos, cada usu√°rio possui limites di√°rios:

- **Gera√ß√µes di√°rias**: m√°ximo de 10 m√∫sicas por dia (configur√°vel).
- **Reset de quota**: autom√°tico √† meia-noite UTC.
- **Tracking de uso**: contador armazenado no banco de dados.

### Informa√ß√µes do Usu√°rio
- Cada usu√°rio pode visualizar seu uso atual em dashboard.
- Campos rastreados:
  - Total de m√∫sicas geradas (lifetime)
  - Gera√ß√µes restantes hoje
  - Data de registro
  - √öltimo acesso

### Valida√ß√µes
- Requisi√ß√µes bloqueadas quando quota di√°ria atingida.
- Mensagem de erro amig√°vel: "Limite di√°rio atingido. Tente novamente amanh√£."

---

## üöÄ Escopo Funcional

### 1. Gera√ß√£o de M√∫sica (Mubert API)
- Input: prompt textual (ex: ‚ÄúDeep sleep ocean ambient with ethereal pads‚Äù).
- Output: URL de arquivo `.mp3` gerado via Mubert.
- Configura√ß√µes: dura√ß√£o, g√™nero, BPM, tags opcionais.

### 2. Gera√ß√£o de Imagem de Capa (DALL¬∑E 3)
- Input: mesmo prompt do usu√°rio (ou ajustado).
- Output: URL da imagem `.png`.
- Resolu√ß√£o padr√£o: 1024x1024.

### 3. Renderiza√ß√£o de V√≠deo (FFmpeg)
- Combina m√∫sica + imagem em um v√≠deo `.mp4`.
- Dura√ß√£o igual √† da faixa.
- Op√ß√£o de fade-in / fade-out autom√°tico.

### 4. Gerenciamento de Hist√≥rico
- Lista de faixas geradas (imagem + player + link de v√≠deo).
- Armazenamento local (SQLite/PostgreSQL) ou Supabase.
- Dados: prompt, URLs, timestamp.

### 5. Upload para YouTube (opcional)
- Login via OAuth2.
- Campos: t√≠tulo, descri√ß√£o, tags, privacidade.
- API: YouTube Data API v3.

---

## üì± Funcionalidades do Frontend

### P√°gina Principal (`/`)
- Exibe formul√°rio com:
  - Textarea para prompt.
  - Bot√£o ‚ÄúGenerate Music‚Äù.
  - Loader animado (shadcn/ui).
- Ap√≥s gera√ß√£o:
  - Exibe imagem da capa.
  - Player de √°udio.
  - Bot√£o ‚ÄúRender Video‚Äù.
  - Bot√£o ‚ÄúUpload to YouTube‚Äù (opcional).

### P√°gina de Hist√≥rico (`/history`)
- Lista de faixas j√° geradas.
- Exibe miniatura + √°udio + status.
- Op√ß√£o de ‚ÄúRegerar‚Äù ou ‚ÄúExcluir‚Äù.

### Layout e UI
- Framework: **Next.js + shadcn/ui + TailwindCSS + Framer Motion**.
- Tema: **dark minimalista** (tons de azul escuro e cinza).
- Componentes:
  - `Card`, `Button`, `Textarea`, `Dialog`, `Progress`, `AudioPlayer`.

---

## ‚öôÔ∏è Funcionalidades do Backend

### API Endpoints (FastAPI)

#### Endpoints de Autentica√ß√£o (P√∫blicos)
| M√©todo | Endpoint | Fun√ß√£o | Autentica√ß√£o |
|---------|-----------|--------|--------------|
| `POST` | `/api/auth/register` | Registra novo usu√°rio | N√£o |
| `POST` | `/api/auth/login` | Realiza login | N√£o |
| `POST` | `/api/auth/refresh` | Renova access token | Refresh Token |
| `POST` | `/api/auth/logout` | Realiza logout | Bearer Token |
| `GET` | `/api/auth/me` | Retorna dados do usu√°rio logado | Bearer Token |

#### Endpoints de Gera√ß√£o (Protegidos)
| M√©todo | Endpoint | Fun√ß√£o | Autentica√ß√£o |
|---------|-----------|--------|--------------|
| `POST` | `/api/generate` | Gera m√∫sica e imagem | Bearer Token |
| `POST` | `/api/render` | Renderiza v√≠deo (FFmpeg) | Bearer Token |
| `POST` | `/api/upload` | Faz upload para YouTube | Bearer Token |
| `GET` | `/api/history` | Lista faixas do usu√°rio | Bearer Token |
| `GET` | `/api/tracks/{track_id}` | Retorna dados de uma faixa | Bearer Token |
| `DELETE` | `/api/tracks/{track_id}` | Deleta uma faixa | Bearer Token |

#### Endpoints de Quota
| M√©todo | Endpoint | Fun√ß√£o | Autentica√ß√£o |
|---------|-----------|--------|--------------|
| `GET` | `/api/quota` | Retorna quota atual do usu√°rio | Bearer Token |

---

### Exemplo de fluxo de requisi√ß√£o

1. Frontend envia:
   ```json
   { "prompt": "Calming space ambient with soft pads and rain" }
   ```
2. Backend:
   - Chama Mubert API ‚Üí gera m√∫sica `.mp3`
   - Chama DALL¬∑E API ‚Üí gera capa `.png`
   - Armazena metadados
   - Retorna URLs para frontend

3. Usu√°rio visualiza pr√©via ‚Üí aciona renderiza√ß√£o ‚Üí recebe `.mp4`.

---

## üß† Integra√ß√µes de IA

| Recurso | Servi√ßo | Forma de Integra√ß√£o |
|----------|----------|--------------------|
| M√∫sica | Mubert API | REST via `requests` |
| Imagem | OpenAI DALL¬∑E 3 | `openai.images.generate()` |
| Render | FFmpeg | subprocess (`ffmpeg -loop 1 ...`) |
| Upload | YouTube Data API v3 | `googleapiclient.discovery` |

---

## ‚öôÔ∏è Especifica√ß√µes T√©cnicas

### Configura√ß√µes de √Åudio
- **Formato**: MP3
- **Bitrate**: 320 kbps (alta qualidade)
- **Sample Rate**: 44.1 kHz
- **Canais**: Stereo
- **Dura√ß√£o padr√£o**: 5-10 minutos (300-600 segundos)
- **Dura√ß√£o m√≠nima**: 2 minutos (120 segundos)
- **Dura√ß√£o m√°xima**: 15 minutos (900 segundos)

### Configura√ß√µes de Imagem
- **Formato**: PNG
- **Resolu√ß√£o**: 1920x1080 pixels (16:9)
- **Qualidade**: Alta (sem compress√£o agressiva)
- **Color Space**: sRGB
- **DPI**: 72 (padr√£o web)

### Configura√ß√µes de V√≠deo
- **Formato**: MP4
- **Codec de v√≠deo**: H.264 (libx264)
- **Codec de √°udio**: AAC
- **Resolu√ß√£o**: 1920x1080 (Full HD 1080p)
- **Frame Rate**: 30 fps
- **Bitrate v√≠deo**: 5000k
- **Bitrate √°udio**: 320k
- **Preset FFmpeg**: `medium` (balan√ßo entre velocidade e qualidade)
- **Efeitos**: fade-in (2s) e fade-out (2s) no √°udio

### Comando FFmpeg de Refer√™ncia
```bash
ffmpeg -loop 1 -i cover.png -i audio.mp3 \
  -c:v libx264 -tune stillimage -c:a aac \
  -b:a 320k -pix_fmt yuv420p -shortest \
  -vf "scale=1920:1080" -r 30 \
  -preset medium -b:v 5000k \
  -af "afade=t=in:st=0:d=2,afade=t=out:st=${duration-2}:d=2" \
  output.mp4
```

### Timeouts e Performance
- **Timeout Mubert API**: 60 segundos
- **Timeout DALL¬∑E API**: 60 segundos
- **Timeout FFmpeg render**: 300 segundos (5 minutos)
- **Tempo estimado de gera√ß√£o completa**: 60-90 segundos
- **Processamento**: S√≠ncrono com feedback de loading para o usu√°rio

---

## üíæ Armazenamento

### Estrat√©gia de Armazenamento
O sistema utiliza **armazenamento local em sistema de arquivos** organizado por usu√°rio.

### Estrutura de Diret√≥rios
```
storage/
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îú‚îÄ‚îÄ {user_id}/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ music/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {track_id}.mp3
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {track_id}.png
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ videos/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ {track_id}.mp4
‚îî‚îÄ‚îÄ temp/
    ‚îî‚îÄ‚îÄ {job_id}/
```

### Detalhes
- **Isolamento por usu√°rio**: cada usu√°rio tem seu pr√≥prio diret√≥rio identificado por `user_id`.
- **Organiza√ß√£o por tipo**: arquivos separados em `music/`, `images/`, `videos/`.
- **Nomenclatura**: todos os arquivos usam `track_id` (UUID) como nome.
- **Diret√≥rio tempor√°rio**: processos de renderiza√ß√£o usam `/temp/{job_id}/` antes de mover para local definitivo.

### Pol√≠ticas de Reten√ß√£o
- **Arquivos permanentes**: mantidos indefinidamente at√© exclus√£o manual pelo usu√°rio.
- **Arquivos tempor√°rios**: limpeza autom√°tica ap√≥s 24h se n√£o movidos para diret√≥rio permanente.
- **Limite de armazenamento**: pode ser implementado posteriormente (ex: 1GB por usu√°rio).

### Estrutura de Dados (PostgreSQL)

#### Tabela: `users`
| Campo | Tipo | Descri√ß√£o |
|--------|------|------------|
| id | UUID | Identificador √∫nico do usu√°rio (PK) |
| email | VARCHAR(255) | Email √∫nico do usu√°rio |
| username | VARCHAR(100) | Nome de usu√°rio |
| password_hash | VARCHAR(255) | Hash bcrypt da senha |
| created_at | TIMESTAMP | Data de cria√ß√£o da conta |
| last_login | TIMESTAMP | √öltimo login |
| is_active | BOOLEAN | Conta ativa/inativa |

#### Tabela: `tracks`
| Campo | Tipo | Descri√ß√£o |
|--------|------|------------|
| id | UUID | Identificador √∫nico da faixa (PK) |
| user_id | UUID | Refer√™ncia ao usu√°rio (FK) |
| prompt | TEXT | Texto descritivo usado na gera√ß√£o |
| music_path | VARCHAR(500) | Caminho local do arquivo MP3 |
| image_path | VARCHAR(500) | Caminho local da imagem PNG |
| video_path | VARCHAR(500) | Caminho local do v√≠deo MP4 (nullable) |
| duration | INTEGER | Dura√ß√£o em segundos |
| created_at | TIMESTAMP | Data/hora de cria√ß√£o |
| status | VARCHAR(50) | Status: 'generated', 'rendered', 'uploaded' |
| youtube_url | VARCHAR(500) | URL do v√≠deo no YouTube (nullable) |

#### Tabela: `user_quotas`
| Campo | Tipo | Descri√ß√£o |
|--------|------|------------|
| id | UUID | Identificador √∫nico (PK) |
| user_id | UUID | Refer√™ncia ao usu√°rio (FK) |
| date | DATE | Data da quota (YYYY-MM-DD) |
| generations_used | INTEGER | N√∫mero de gera√ß√µes usadas no dia |
| daily_limit | INTEGER | Limite di√°rio configurado (padr√£o: 10) |
| created_at | TIMESTAMP | Data de cria√ß√£o do registro |

#### Tabela: `refresh_tokens`
| Campo | Tipo | Descri√ß√£o |
|--------|------|------------|
| id | UUID | Identificador √∫nico (PK) |
| user_id | UUID | Refer√™ncia ao usu√°rio (FK) |
| token | VARCHAR(500) | Hash do refresh token |
| expires_at | TIMESTAMP | Data de expira√ß√£o |
| created_at | TIMESTAMP | Data de cria√ß√£o |
| revoked | BOOLEAN | Token revogado? |

### Relacionamentos
- `tracks.user_id` ‚Üí `users.id` (Many-to-One)
- `user_quotas.user_id` ‚Üí `users.id` (Many-to-One)
- `refresh_tokens.user_id` ‚Üí `users.id` (Many-to-One)

---

## üß± Estrutura do Projeto

```
ai-ambient-music-generator/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                          # Entry point FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ config.py                        # Configura√ß√µes e vari√°veis de ambiente
‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py                  # Dependency injection (DB, Auth)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                      # Registro, login, refresh, logout
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate.py                  # Gera√ß√£o de m√∫sica + imagem
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ render.py                    # Renderiza√ß√£o de v√≠deo
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ upload.py                    # Upload para YouTube
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tracks.py                    # CRUD de tracks
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ quota.py                     # Consulta de quota do usu√°rio
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mubert_service.py            # Integra√ß√£o Mubert API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dalle_service.py             # Integra√ß√£o DALL¬∑E (OpenAI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ffmpeg_service.py            # Renderiza√ß√£o de v√≠deo
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ youtube_service.py           # Upload YouTube
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage_service.py           # Gerenciamento de arquivos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ quota_service.py             # L√≥gica de quotas
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                      # Modelo User (SQLAlchemy)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ track.py                     # Modelo Track
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_quota.py                # Modelo UserQuota
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ refresh_token.py             # Modelo RefreshToken
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                      # Pydantic schemas (User, UserCreate, UserResponse)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ track.py                     # Pydantic schemas (Track, TrackCreate)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                      # Schemas de login/registro
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ quota.py                     # Schema de quota
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_middleware.py           # Middleware JWT
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cors_middleware.py           # Configura√ß√£o CORS
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rate_limit_middleware.py     # Rate limiting
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt_handler.py               # Cria√ß√£o e valida√ß√£o de JWT
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ password.py                  # Hash e verifica√ß√£o de senha
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validators.py                # Validadores customizados
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.py                    # Configura√ß√£o de logging
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py                        # Configura√ß√£o SQLAlchemy
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/                  # Alembic migrations
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ versions/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_auth.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_generate.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_quota.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ register/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (protected)/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx               # Layout com AuthGuard
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx             # Dashboard principal
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx             # Gera√ß√£o de m√∫sica
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ history/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx             # Hist√≥rico de faixas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                     # Landing page
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                          # shadcn/ui components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialog.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthGuard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PromptForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GenerationLoader.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ResultPreview.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tracks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TrackCard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TrackList.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AudioPlayer.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ video/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ VideoPreview.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Navbar.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Sidebar.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ QuotaDisplay.tsx
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts                       # Axios client configurado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts                      # Fun√ß√µes de autentica√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts                     # Utilidades
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts                   # Hook de autentica√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useGenerate.ts               # Hook de gera√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useQuota.ts                  # Hook de quota
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ contexts/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx              # Context de autentica√ß√£o
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ track.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ next.config.js
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.ts
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ .env.local.example
‚îÇ
‚îú‚îÄ‚îÄ storage/                             # Diret√≥rio de armazenamento (git ignored)
‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {user_id}/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ music/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ videos/
‚îÇ   ‚îî‚îÄ‚îÄ temp/
‚îÇ
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf                       # Configura√ß√£o Nginx
‚îÇ   ‚îî‚îÄ‚îÄ ssl/                             # Certificados SSL
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ product-requirements-document.md # Este arquivo
‚îÇ   ‚îú‚îÄ‚îÄ api-documentation.md             # Documenta√ß√£o da API
‚îÇ   ‚îî‚îÄ‚îÄ setup-guide.md                   # Guia de configura√ß√£o
‚îÇ
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ ci-cd.yml                    # GitHub Actions
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ docker-compose.prod.yml
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ LICENSE
```

---

## üß∞ Tecnologias e Bibliotecas

### Frontend
- `next@15`
- `tailwindcss`
- `shadcn/ui`
- `framer-motion`
- `axios`
- `react-icons`

### Backend
- `fastapi`
- `httpx` / `requests`
- `pydantic`
- `openai`
- `ffmpeg-python`
- `sqlalchemy`
- `google-api-python-client`

---

## üõ†Ô∏è Setup e Desenvolvimento Local

### Pr√©-requisitos
- **Git**: controle de vers√£o
- **Docker** e **Docker Compose**: 20.10+
- **Python**: 3.11+ (se rodar backend sem Docker)
- **Node.js**: 18+ e npm/yarn (se rodar frontend sem Docker)
- **FFmpeg**: instalado no sistema (se rodar sem Docker)

### Instala√ß√£o - Op√ß√£o 1: Docker (Recomendado)

#### 1. Clone o reposit√≥rio
```bash
git clone https://github.com/yourusername/ai-ambient-music-generator.git
cd ai-ambient-music-generator
```

#### 2. Configure vari√°veis de ambiente
```bash
cp .env.example .env
# Edite o arquivo .env com suas credenciais
nano .env
```

**Vari√°veis obrigat√≥rias para desenvolvimento:**
```bash
# Database
POSTGRES_DB=ai_music_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=localdev123

# JWT
JWT_SECRET_KEY=dev_secret_key_minimum_32_characters_long_please

# API Keys
OPENAI_API_KEY=sk-your-openai-key
MUBERT_API_KEY=your-mubert-key  # ou mock para desenvolvimento
```

#### 3. Inicialize os containers
```bash
docker-compose up -d --build
```

#### 4. Execute migra√ß√µes do banco
```bash
docker-compose exec backend alembic upgrade head
```

#### 5. Acesse a aplica√ß√£o
- **Frontend**: http://localhost:3000
- **Backend API**: http://localhost:8000
- **API Docs**: http://localhost:8000/docs (Swagger UI)

### Instala√ß√£o - Op√ß√£o 2: Manual (Sem Docker)

#### Backend

```bash
cd backend

# Criar ambiente virtual
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Instalar depend√™ncias
pip install -r requirements.txt

# Configurar .env
cp .env.example .env
# Editar com suas credenciais

# Executar migra√ß√µes
alembic upgrade head

# Rodar servidor
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

#### Frontend

```bash
cd frontend

# Instalar depend√™ncias
npm install

# Configurar vari√°veis de ambiente
cp .env.local.example .env.local
# Editar NEXT_PUBLIC_API_URL=http://localhost:8000/api

# Rodar em desenvolvimento
npm run dev
```

#### PostgreSQL Local
```bash
# Instalar PostgreSQL
sudo apt install postgresql postgresql-contrib  # Ubuntu/Debian
brew install postgresql@15                      # macOS

# Criar banco de dados
createdb ai_music_db
```

### Desenvolvimento

#### Comandos √öteis

**Backend:**
```bash
# Rodar testes
pytest

# Criar nova migration
alembic revision --autogenerate -m "description"

# Aplicar migrations
alembic upgrade head

# Reverter migration
alembic downgrade -1

# Linting e formata√ß√£o
black .
flake8 .
```

**Frontend:**
```bash
# Rodar testes
npm test

# Build de produ√ß√£o
npm run build

# Linting
npm run lint

# Type checking
npm run type-check
```

**Docker:**
```bash
# Ver logs
docker-compose logs -f

# Rebuild ap√≥s mudan√ßas
docker-compose up -d --build

# Parar containers
docker-compose down

# Limpar volumes (cuidado!)
docker-compose down -v

# Acessar shell do container
docker-compose exec backend bash
docker-compose exec frontend sh
```

### Estrutura de Branches

```
main            # Branch principal (produ√ß√£o)
‚îú‚îÄ‚îÄ develop     # Branch de desenvolvimento
‚îÇ   ‚îú‚îÄ‚îÄ feature/user-auth
‚îÇ   ‚îú‚îÄ‚îÄ feature/music-generation
‚îÇ   ‚îî‚îÄ‚îÄ feature/video-rendering
‚îî‚îÄ‚îÄ hotfix/     # Corre√ß√µes urgentes
```

### Workflow de Desenvolvimento

1. **Criar branch a partir de develop**
   ```bash
   git checkout develop
   git pull origin develop
   git checkout -b feature/nome-da-feature
   ```

2. **Desenvolver e testar localmente**
   ```bash
   # Fazer commits incrementais
   git add .
   git commit -m "feat: adiciona endpoint de autentica√ß√£o"
   ```

3. **Push e criar Pull Request**
   ```bash
   git push origin feature/nome-da-feature
   # Abrir PR no GitHub para develop
   ```

4. **Code Review e Merge**
   - Aguardar aprova√ß√£o
   - Merge para develop
   - Deploy autom√°tico em staging (se configurado)

### Troubleshooting

#### Problema: FFmpeg n√£o encontrado
```bash
# Ubuntu/Debian
sudo apt install ffmpeg

# macOS
brew install ffmpeg

# Verificar instala√ß√£o
ffmpeg -version
```

#### Problema: Erro de conex√£o com banco de dados
```bash
# Verificar se PostgreSQL est√° rodando
docker-compose ps
# ou
sudo systemctl status postgresql

# Verificar credenciais no .env
cat .env | grep POSTGRES
```

#### Problema: Porta j√° em uso
```bash
# Verificar processos na porta 8000
lsof -i :8000

# Matar processo
kill -9 <PID>

# Ou alterar porta no docker-compose.yml
```

#### Problema: Erro de CORS
- Verificar `CORS_ORIGINS` no `.env` do backend
- Adicionar `http://localhost:3000` se necess√°rio

### Ferramentas Recomendadas

- **IDE**: VSCode com extens√µes Python e TypeScript
- **API Testing**: Postman ou Insomnia
- **Database Client**: DBeaver ou pgAdmin
- **Git GUI**: GitKraken ou GitHub Desktop (opcional)

---

## üê≥ Deploy

### Ambiente de Produ√ß√£o: AWS EC2 com Docker

#### Arquitetura
- **Servidor**: AWS EC2 (recomendado: t3.medium ou superior)
- **OS**: Ubuntu 22.04 LTS
- **Orquestra√ß√£o**: Docker Compose
- **Reverse Proxy**: Nginx
- **SSL**: Let's Encrypt (Certbot)
- **Banco de Dados**: PostgreSQL em container Docker com volume persistente

#### Requisitos de Infraestrutura
- **CPU**: 2+ vCPUs (para processamento FFmpeg)
- **RAM**: 4GB+ (8GB recomendado para m√∫ltiplas gera√ß√µes simult√¢neas)
- **Storage**: 50GB+ SSD (para armazenar m√∫sicas, imagens e v√≠deos)
- **Security Group**:
  - Porta 22 (SSH)
  - Porta 80 (HTTP)
  - Porta 443 (HTTPS)

### Docker Compose (Production)
```yaml
version: "3.8"

services:
  postgres:
    image: postgres:15-alpine
    container_name: ai-music-db
    environment:
      POSTGRES_DB: ${POSTGRES_DB}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - app-network
    restart: unless-stopped

  backend:
    build: ./backend
    container_name: ai-music-backend
    ports:
      - "8000:8000"
    env_file:
      - .env
    volumes:
      - ./storage:/app/storage
    depends_on:
      - postgres
    networks:
      - app-network
    restart: unless-stopped

  frontend:
    build: ./frontend
    container_name: ai-music-frontend
    ports:
      - "3000:3000"
    environment:
      NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL}
    depends_on:
      - backend
    networks:
      - app-network
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    container_name: ai-music-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./nginx/ssl:/etc/nginx/ssl
    depends_on:
      - frontend
      - backend
    networks:
      - app-network
    restart: unless-stopped

volumes:
  postgres_data:

networks:
  app-network:
    driver: bridge
```

### Configura√ß√£o Nginx (Reverse Proxy)
```nginx
upstream backend {
    server backend:8000;
}

upstream frontend {
    server frontend:3000;
}

server {
    listen 80;
    server_name yourdomain.com;

    location /api {
        proxy_pass http://backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location / {
        proxy_pass http://frontend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### Passos de Deploy

1. **Configurar EC2 Instance**
   ```bash
   # Instalar Docker e Docker Compose
   sudo apt update
   sudo apt install -y docker.io docker-compose
   sudo usermod -aG docker $USER
   ```

2. **Clonar reposit√≥rio e configurar**
   ```bash
   git clone <repository-url>
   cd ai-ambient-music-generator
   cp .env.example .env
   # Editar .env com credenciais reais
   ```

3. **Build e executar containers**
   ```bash
   docker-compose up -d --build
   ```

4. **Configurar SSL (Let's Encrypt)**
   ```bash
   sudo apt install certbot python3-certbot-nginx
   sudo certbot --nginx -d yourdomain.com
   ```

5. **Verificar status**
   ```bash
   docker-compose ps
   docker-compose logs -f
   ```

---

## üîê Vari√°veis de Ambiente

### Arquivo `.env` (Backend)

```bash
# === Database ===
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=ai_music_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_secure_password_here

# === JWT Configuration ===
JWT_SECRET_KEY=your_super_secret_jwt_key_min_32_chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# === API Keys ===
MUBERT_API_KEY=your_mubert_api_key_here
MUBERT_API_LICENSE=your_mubert_license_key
OPENAI_API_KEY=sk-your-openai-api-key-here

# === YouTube API ===
YOUTUBE_CLIENT_ID=your_google_oauth_client_id
YOUTUBE_CLIENT_SECRET=your_google_oauth_client_secret
YOUTUBE_REDIRECT_URI=http://localhost:8000/api/auth/youtube/callback

# === Storage ===
STORAGE_PATH=/app/storage
TEMP_PATH=/app/storage/temp
MAX_STORAGE_PER_USER_GB=5

# === Quotas ===
DEFAULT_DAILY_GENERATION_LIMIT=10

# === Application ===
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com
ENVIRONMENT=production

# === FFmpeg ===
FFMPEG_TIMEOUT_SECONDS=300
```

### Arquivo `.env.local` (Frontend)

```bash
# === API Configuration ===
NEXT_PUBLIC_API_URL=http://localhost:8000/api

# === Environment ===
NODE_ENV=development
```

### Arquivo `.env.example`
Criar um arquivo `.env.example` no reposit√≥rio com valores placeholder:

```bash
# Database
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=ai_music_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=change_me

# JWT
JWT_SECRET_KEY=change_me_min_32_characters_long
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# API Keys
MUBERT_API_KEY=your_mubert_api_key
MUBERT_API_LICENSE=your_mubert_license
OPENAI_API_KEY=your_openai_api_key

# Storage
STORAGE_PATH=/app/storage
TEMP_PATH=/app/storage/temp
MAX_STORAGE_PER_USER_GB=5

# Quotas
DEFAULT_DAILY_GENERATION_LIMIT=10

# Application
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
CORS_ORIGINS=http://localhost:3000
ENVIRONMENT=development
```

### Seguran√ßa de Vari√°veis de Ambiente
- **NUNCA** commitar arquivo `.env` no Git (adicionar ao `.gitignore`)
- Usar ferramentas como `python-dotenv` para carregar vari√°veis
- Em produ√ß√£o, considerar usar AWS Secrets Manager ou similar
- Rotacionar chaves JWT periodicamente

---

## ‚ö†Ô∏è Tratamento de Erros e Valida√ß√µes

### Valida√ß√µes de Input

#### Registro de Usu√°rio
- **Email**: formato v√°lido, √∫nico no sistema
- **Password**: m√≠nimo 8 caracteres, m√°ximo 100 caracteres
- **Username**: 3-50 caracteres, alfanum√©rico + underscore

#### Gera√ß√£o de M√∫sica
- **Prompt**:
  - M√≠nimo: 10 caracteres
  - M√°ximo: 500 caracteres
  - Sanitiza√ß√£o: remover HTML/scripts
- **Dura√ß√£o**: entre 120-900 segundos
- **Quota**: verificar limite di√°rio n√£o atingido

### Tratamento de Erros por Servi√ßo

#### Erros de API Externa

**Mubert API**
- **Timeout**: 60s ‚Üí Erro 504 Gateway Timeout
- **Rate Limit**: Retry ap√≥s 1 minuto com exponential backoff
- **API Key inv√°lida**: Erro 500 com log, n√£o expor detalhes ao usu√°rio
- **Response**:
  ```json
  {
    "error": "Falha ao gerar m√∫sica. Tente novamente em alguns instantes.",
    "code": "MUSIC_GENERATION_FAILED"
  }
  ```

**OpenAI DALL¬∑E**
- **Timeout**: 60s ‚Üí Erro 504
- **Content Policy Violation**: Retornar erro amig√°vel sugerindo modificar prompt
- **Rate Limit**: Retry com backoff
- **Response**:
  ```json
  {
    "error": "N√£o foi poss√≠vel gerar a imagem. Por favor, reformule seu prompt.",
    "code": "IMAGE_GENERATION_FAILED",
    "suggestion": "Evite termos que possam violar pol√≠ticas de conte√∫do"
  }
  ```

**FFmpeg Rendering**
- **Timeout**: 300s ‚Üí Erro 504
- **Arquivo inv√°lido**: Verificar integridade antes de renderizar
- **Falta de espa√ßo**: Verificar espa√ßo em disco antes de iniciar
- **Response**:
  ```json
  {
    "error": "Falha ao renderizar v√≠deo. Tente novamente.",
    "code": "VIDEO_RENDERING_FAILED"
  }
  ```

#### Erros de Autentica√ß√£o
- **401 Unauthorized**: Token inv√°lido ou expirado
- **403 Forbidden**: Permiss√£o negada para recurso
- **Response padr√£o**:
  ```json
  {
    "error": "Autentica√ß√£o necess√°ria. Fa√ßa login novamente.",
    "code": "UNAUTHORIZED"
  }
  ```

#### Erros de Quota
- **429 Too Many Requests**: Limite di√°rio atingido
- **Response**:
  ```json
  {
    "error": "Limite di√°rio de gera√ß√µes atingido.",
    "code": "QUOTA_EXCEEDED",
    "reset_time": "2025-10-23T00:00:00Z",
    "current_usage": 10,
    "limit": 10
  }
  ```

### Retry Logic

#### Configura√ß√£o de Retry
```python
# Retry para APIs externas
MAX_RETRIES = 3
RETRY_DELAY = [1, 2, 4]  # segundos (exponential backoff)
RETRY_ON = [408, 429, 500, 502, 503, 504]  # HTTP status codes
```

#### Opera√ß√µes que N√ÉO devem ter retry autom√°tico
- Valida√ß√µes de input (400 Bad Request)
- Erros de autentica√ß√£o (401, 403)
- Recursos n√£o encontrados (404)
- Viola√ß√£o de pol√≠ticas de conte√∫do

### Logging

#### N√≠veis de Log
- **INFO**: Requisi√ß√µes bem-sucedidas, in√≠cio/fim de processos
- **WARNING**: Retry de opera√ß√£o, quota pr√≥xima do limite
- **ERROR**: Falha em API externa, erro de renderiza√ß√£o
- **CRITICAL**: Falha de banco de dados, storage inacess√≠vel

#### Formato de Log
```python
{
  "timestamp": "2025-10-22T15:30:00Z",
  "level": "ERROR",
  "service": "mubert_service",
  "user_id": "uuid-here",
  "track_id": "uuid-here",
  "message": "Mubert API timeout after 60s",
  "stack_trace": "..."
}
```

### Mensagens de Erro Amig√°veis (Frontend)

| C√≥digo de Erro | Mensagem ao Usu√°rio |
|----------------|---------------------|
| `MUSIC_GENERATION_FAILED` | "N√£o conseguimos gerar sua m√∫sica. Por favor, tente novamente." |
| `IMAGE_GENERATION_FAILED` | "Erro ao criar a imagem. Tente modificar seu prompt." |
| `VIDEO_RENDERING_FAILED` | "Falha ao criar o v√≠deo. Nossa equipe foi notificada." |
| `QUOTA_EXCEEDED` | "Voc√™ atingiu o limite de gera√ß√µes hoje. Volte amanh√£!" |
| `UNAUTHORIZED` | "Sess√£o expirada. Por favor, fa√ßa login novamente." |
| `INVALID_INPUT` | "Verifique os dados informados e tente novamente." |

---

## üîí Requisitos N√£o-Funcionais

### Performance
- **Resposta inicial**: < 5 segundos para gera√ß√£o de m√∫sica/imagem
- **Renderiza√ß√£o de v√≠deo**: < 60 segundos para faixas de 5-10 minutos
- **Lat√™ncia API**: < 200ms para endpoints de autentica√ß√£o
- **Throughput**: suportar 10+ usu√°rios simult√¢neos

### Experi√™ncia do Usu√°rio (UX)
- **Interface**: fluida, minimalista e responsiva (mobile-first)
- **Loading states**: feedback visual em todas as opera√ß√µes longas
- **Acessibilidade**: seguir WCAG 2.1 Level AA
- **Internacionaliza√ß√£o**: preparado para i18n (portugu√™s como padr√£o)

### Licenciamento
- **M√∫sica**: apenas faixas royalty-free (Mubert License)
- **Imagens**: geradas via DALL¬∑E com direitos de uso comercial
- **Compliance**: respeitar termos de uso de todas as APIs

### Seguran√ßa

#### Autentica√ß√£o e Autoriza√ß√£o
- **JWT**: tokens assinados com algoritmo HS256 ou RS256
- **Password hashing**: bcrypt com salt rounds = 12
- **Refresh tokens**: armazenados hasheados no banco, rota√ß√£o autom√°tica
- **Session management**: logout invalida tokens no servidor

#### Prote√ß√£o de APIs
- **CORS**: configurado para permitir apenas origins autorizados
  ```python
  CORS_ORIGINS = ["https://yourdomain.com", "http://localhost:3000"]
  ```
- **Rate Limiting**: m√°ximo de requisi√ß√µes por IP/usu√°rio
  - Login: 5 tentativas por 15 minutos
  - Registro: 3 tentativas por hora
  - Gera√ß√£o: 10 por dia por usu√°rio (quota)
- **CSRF Protection**: tokens CSRF em formul√°rios sens√≠veis

#### Valida√ß√£o e Sanitiza√ß√£o
- **Input validation**: Pydantic models no backend para valida√ß√£o de schemas
- **SQL Injection**: uso de ORM (SQLAlchemy) com parameterized queries
- **XSS Protection**: sanitiza√ß√£o de HTML em prompts do usu√°rio
- **Path Traversal**: valida√ß√£o rigorosa de caminhos de arquivo

#### Prote√ß√£o de Dados
- **Sensitive data**: nunca logar senhas, tokens ou API keys
- **Environment variables**: nunca commitar .env no reposit√≥rio
- **HTTPS**: obrigat√≥rio em produ√ß√£o (certificado Let's Encrypt)
- **Headers de seguran√ßa**:
  ```python
  X-Content-Type-Options: nosniff
  X-Frame-Options: DENY
  X-XSS-Protection: 1; mode=block
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  ```

#### Isolamento de Recursos
- **Multi-tenancy**: isolamento completo de arquivos e dados por usu√°rio
- **Permissions**: usu√°rio s√≥ acessa seus pr√≥prios recursos
- **File access**: validar user_id antes de servir arquivos

#### Monitoramento e Auditoria
- **Logging**: registrar todas as a√ß√µes cr√≠ticas (login, gera√ß√£o, exclus√£o)
- **Alertas**: notificar em caso de m√∫ltiplas tentativas de login falhadas
- **Audit trail**: manter hist√≥rico de a√ß√µes por usu√°rio

#### Backup e Recupera√ß√£o
- **Database**: backup di√°rio autom√°tico do PostgreSQL
- **Arquivos**: considerar backup incremental do storage
- **RTO**: Recovery Time Objective < 4 horas
- **RPO**: Recovery Point Objective < 24 horas

### Manuten√ß√£o e Extensibilidade
- **C√≥digo modular**: seguir princ√≠pios SOLID
- **Documenta√ß√£o**: docstrings em todas as fun√ß√µes
- **Testes**: cobertura m√≠nima de 70%
- **CI/CD**: pipeline automatizado para testes e deploy
- **Versionamento**: semantic versioning (semver)

---

## ü™∂ Futuras Extens√µes

- Gera√ß√£o em lote (playlist autom√°tica).  
- Customiza√ß√£o de par√¢metros sonoros (BPM, dura√ß√£o, g√™nero).  
- Sistema de tags e curadoria de faixas.  
- Dashboard de estat√≠sticas (views, engajamento no YouTube).  
- Integra√ß√£o com Supabase Auth e Storage.

---

## üìÖ Roadmap (Fases)

| Fase | Entrega | Descri√ß√£o |
|------|----------|------------|
| **1. MVP** | Gera√ß√£o m√∫sica + imagem | Pipeline b√°sico funcionando |
| **2. Renderiza√ß√£o** | FFmpeg + preview | Cria√ß√£o do v√≠deo final |
| **3. Dashboard** | Hist√≥rico e status | Armazenamento e listagem |
| **4. Upload** | Integra√ß√£o YouTube | Publica√ß√£o automatizada |
| **5. Automa√ß√£o** | Lotes + agendamento | Escalabilidade |

---

## üßë‚Äçüíª Autor
**Gabriel Silveira de Souza**  
Software Developer / Music Composer  
2025 ¬© All Rights Reserved
